"use strict";CKEDITOR.dialog.add("image2",function(t){function e(){var t=this.getValue().match(p),e=!(!t||0===parseInt(t[1],10));return e||alert(f["invalid"+CKEDITOR.tools.capitalize(this.id)]),e}function i(){function t(t,n){a.push(i.once(t,function(t){e(),n(t)}))}function e(){for(var t;t=a.pop();)t.removeListener()}var i=n.createElement("img"),a=[];return function(e,a,n){t("load",function(){var t=V(i);a.call(n,i,t.width)}),t("error",function(){a(null)}),t("abort",function(){a(null)}),i.setAttribute("src",(y.baseHref||"")+e+"?"+Math.random().toString(16).substring(2))}}function a(){var t=this.getValue();t!==o.data.src?(s(t,function(t,e){h.setValue(e),r=e}),d=!0):d&&(h.setValue(u),d=!1)}var n,o,l,s,u,r,d,c,h,g,p=/(^\s*(\d+)(\%)?\s*$)|^$/i,m=t.lang.image2,f=t.lang.common,b=CKEDITOR.plugins.image2,y=t.config,x=t.widgets.registered.image.features,V=(b.checkHasNaturalRatio,b.getNatural),w=!(!y.filebrowserImageBrowseUrl&&!y.filebrowserBrowseUrl),D=[{id:"src",type:"text",label:f.url,onKeyup:a,onChange:a,setup:function(t){this.setValue(t.data.src)},commit:function(t){t.setData("src",this.getValue())},validate:CKEDITOR.dialog.validate.notEmpty(m.urlMissing)}];return w&&D.push({type:"button",id:"browse",style:"display:inline-block;margin-top:18px;",align:"center",label:t.lang.common.browseServer,hidden:!0,filebrowser:"info:src"}),{title:m.title,minWidth:250,minHeight:100,onLoad:function(){n=this._.element.getDocument(),s=i()},onShow:function(){o=this.widget,l=o.parts.image,d=!1,g=V(l),r=u=g.width},contents:[{id:"info",label:m.infoTab,elements:[{type:"vbox",padding:0,children:[{type:"hbox",widths:["100%"],children:D}]},{id:"alt",type:"text",label:m.alt,setup:function(t){this.setValue(t.data.alt)},commit:function(t){t.setData("alt",this.getValue())}},{type:"hbox",children:[{type:"text",width:"45px",id:"width",label:f.width+" (%)",validate:e,onLoad:function(){c=this},setup:function(t){this.setValue(t.data.width)},commit:function(t){t.setData("width",this.getValue())}},{type:"text",hidden:!0,width:"45px",id:"maxWidth",label:"Max "+f.width+" (px)",onLoad:function(){h=this},setup:function(t){this.setValue(t.data.maxWidth)},commit:function(t){t.setData("maxWidth",this.getValue())}}]},{type:"hbox",id:"alignment",requiredContent:x.align.requiredContent,children:[{id:"align",type:"radio",items:[[f.alignNone,"none"],[f.alignLeft,"left"],[f.alignCenter,"center"],[f.alignRight,"right"]],label:f.align,setup:function(t){this.setValue(t.data.align)},commit:function(t){t.setData("align",this.getValue())}}]},{type:"vbox",padding:0,children:[{type:"html",html:"<label>Margins</label>"},{type:"hbox",children:[{type:"checkbox",id:"marginTop",label:"Top",setup:function(t){this.setValue(t.data.marginTop)},commit:function(t){t.setData("marginTop",this.getValue())}},{type:"checkbox",id:"marginLeft",label:"Left",setup:function(t){this.setValue(t.data.marginLeft)},commit:function(t){t.setData("marginLeft",this.getValue())}},{type:"checkbox",id:"marginBottom",label:"Bottom",setup:function(t){this.setValue(t.data.marginBottom)},commit:function(t){t.setData("marginBottom",this.getValue())}},{type:"checkbox",id:"marginRight",label:"Right",setup:function(t){this.setValue(t.data.marginRight)},commit:function(t){t.setData("marginRight",this.getValue())}}]}]},{id:"hasCaption",type:"checkbox",label:m.captioned,requiredContent:x.caption.requiredContent,setup:function(t){this.setValue(t.data.hasCaption)},commit:function(t){t.setData("hasCaption",this.getValue())}}]},{id:"Upload",hidden:!0,filebrowser:"uploadButton",label:m.uploadTab,elements:[{type:"file",id:"upload",label:m.btnUpload,style:"height:40px"},{type:"fileButton",id:"uploadButton",filebrowser:"info:src",label:m.btnUpload,"for":["Upload","upload"]}]}]}});